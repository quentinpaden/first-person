<html>
  <head>
    <!----Aframe Plugins---->
    <script src="https://cdn.jsdelivr.net/npm/aframe-scene@1.0.3/dist/aframe-master.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/aframe-camera-cube-env@1.1.0/camera-cube-env.js"></script>
    
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.0.1/dist/aframe-extras.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/aframe-touch-look-controls@1.1.0/touch-look-controls.js"></script>

    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/npm/aframe-mouse-rotate@1.1.0/mouse-rotate.js"></script>

    <script src="https://rawgit.com/feiss/aframe-environment-component/master/dist/aframe-environment-component.min.js"></script>

    <!----Verse Gameplay Scripts---->
    <script>
      AFRAME.registerComponent('no-occlusion', {
        init: function () {
            this.el.addEventListener("model-loaded", (e)=>{
            var obj = this.el.getObject3D('mesh');
            obj.traverse( function( object ) {

                object.frustumCulled = false;

            } );
          })
        }
      });
    </script>

    <script>
      AFRAME.registerComponent('controller', {
        init: function () {
          var isMobile = /Android|webOS|iPad|iPhone|iPod/.test(navigator.platform)|| (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)
          
          if(isMobile){
            const controls = document.getElementById('Camera');
            controls.setAttribute('touch-look-controls', {
              enabled: true,
            });
          }
          else{
            const controls = document.getElementById('Camera');
            controls.setAttribute('touch-look-controls', {
              enabled: false,
            });
          }

        }
      });
    </script>
  </head>

  
  <!----Verse Game Scene---->
  <body>
      <a-scene 
        renderer="antialias: true; logarithmicDepthBuffer; true;"
        physics="gravity:0;"
        vr-mode-ui="enabled: false"
        loading-screen="enabled: false">

        <!----3D Skybox---->
        <a-sky 
          id="Skybox"
          src="" 
          material=" 
            side: back; 
            shader: skyshader; 
            sunPosition: 17 30 27;">
        </a-sky>
        
        <!----Camera Controls---->
        <a-entity 
          id="Player" 
          position="0 0 6"
          movement-controls="speed:0.25; fly:false; constrainToNavMesh: true;"
          >
            <a-entity 
              id="Camera"
              camera 
              controller
              position="0 1.3 3" 
              cursor="rayOrgin:mouse; fuse:false;"
              look-controls="reverseTouchDrag: true;">
                            
                  <a-entity 
                    id="Weapon" 
                    shadow
                    camera-cube-env="resolution:100;"
                    animation-mixer="clip:PlayerAttack;"
                    scale=".03 .03 .03" 
                    rotation="-90 0 0" 
                    position="0 0 0" 
                    gltf-model="https://firebasestorage.googleapis.com/v0/b/timbre-d11e2.appspot.com/o/assets%2F88578100-bfbf-44eb-b73a-542a12d671b8.glb?alt=media&token=1950ba3a-836c-478a-b801-c88985993e55">
                  </a-entity>
                  <a-cursor fuse="false">
                  </a-cursor>
            </a-entity>
        </a-entity>

        <!--Game World-->
        <a-entity 
          id="World" 
          static-body="shape: box;"
          scale="4 4 4" 
          rotation="0 0 0" 
          position="0 0 4" 
          gltf-model="https://firebasestorage.googleapis.com/v0/b/timbre-d11e2.appspot.com/o/assets%2F8677a6d7-b46c-47ee-ab50-bae003b24348.glb?alt=media&token=1fb3d4a4-6b07-4c2a-8573-87d9dcbf9a14">
        </a-entity>
        
        <!--Game Enemy -->
        <a-entity 
          id="Enemy" 
          animation-mixer="clip:Idle;"
          no-occlusion
          scale="1.3 1.3 1.3" 
          rotation="0 0 0" 
          position="0 -.3 4" 
          gltf-model="https://firebasestorage.googleapis.com/v0/b/timbre-d11e2.appspot.com/o/assets%2F495de0c0-00d4-46db-9c3b-5a9b975ea010.glb?alt=media&token=4fd3f269-1636-44e7-91a3-f842896c21c3">
        </a-entity>
        </a-box>

        <!--Game Navigation-->
        <a-entity 
          id="NavMesh" 
          nav-mesh
          visible="true" 
          scale="5 5 5" 
          rotation="0 0 0" 
          position="0 -.8 4" 
          gltf-model="">
        </a-entity>

        <!-- Default lighting injected by A-Frame. -->
        <a-entity id="Ambient" light="type: ambient; color: #FFF; intensity: 1" position="5 4 3"></a-entity>
        <a-entity  id="Point" light="type: point; color: #FFF; intensity: 0.4" position="1 3 -8"></a-entity>
        <a-entity id="Direction" light="type: directional; color: #FFF; intensity: 0.7; " position="-0.5 1 1"></a-entity>
        
      </a-scene>
  </body>
</html>